"""–ú–æ–¥—É–ª—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–µ—Ç—Å–∫–∏—Ö —Ü–µ–Ω—Ç—Ä–æ–≤ —Ä–∞–∑–≤–∏—Ç–∏—è. –ë–ª–µ–∞—Ç—å!

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ, –¥–∞–Ω–Ω—ã–µ –æ –±–∏–∑–Ω–µ—Å–∞—Ö –∏ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è
–∏–∑ CSV-—Ñ–∞–π–ª–æ–≤, –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–±—Ä–∞—Ç—å —Ä–µ–≥–∏–æ–Ω—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç
—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤.
"""

import csv
import math
from create_table import print_fancy_table, format_fancy_table

# –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –¥–∞–Ω–Ω—ã–µ
def format_currency(amount):
    """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –¥–µ–Ω–µ–∂–Ω—ã–µ —Å—É–º–º—ã —Å –ø—Ä–æ–±–µ–ª–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 155000 ‚Üí "155 000")."""
    if isinstance(amount, int):
        return f'{amount:,}'.replace(',', ' ')
    return str(amount)

# –¢–µ–∫—Å—Ç–æ–≤—ã–µ –º–µ—Ç–∫–∏ –¥–ª—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
profitability_labels = {
    'low': '–Ω–∏–∑–∫–∏–π',
    'regular': '–æ–±—ã—á–Ω—ã–π',
    'high': '–≤—ã—Å–æ–∫–∏–π'
}

# –¢–µ–∫—Å—Ç–æ–≤—ã–µ –º–µ—Ç–∫–∏ –¥–ª—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
competition_labels = {
    'low': '–Ω–∏–∑–∫–∏–π',
    'medium': '—É–º–µ—Ä–µ–Ω–Ω—ã–π',
    'high': '–≤—ã—Å–æ–∫–∏–π'
}

def load_regions(filename='regions.csv'):
    """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º –∏–∑ CSV-—Ñ–∞–π–ª–∞.
    
    –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:
        region;children_5_7;avg_rent_per_sqm
        –ö–∞–∑–∞–Ω—å;41800;1050
        ...
        
    Args:
        filename (str, optional): –ü—É—Ç—å –∫ CSV-—Ñ–∞–π–ª—É —Å –¥–∞–Ω–Ω—ã–º–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 'regions.csv'.
        
    Returns:
        dict: –°–ª–æ–≤–∞—Ä—å –≤–∏–¥–∞:
            {
                "–ö–∞–∑–∞–Ω—å": {"children_5_7": 41800, "avg_rent_per_sqm": 1050},
                ...
            }
            
    –ò—Å–∫–ª—é—á–µ–Ω–∏—è:
        FileNotFoundError: –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω.
        KeyError, ValueError, TypeError: –ü—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª–µ.
    """
    regions_data = {} # –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º
    
    with open(filename, "r", encoding="utf-8") as file: # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
        # –£–∫–∞–∑—ã–≤–∞–µ–º delimiter=';', —Ç–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π
        reader = csv.DictReader(file, delimiter=";") # –°–æ–∑–¥–∞–µ–º –∏—Ç–µ—Ä–∞—Ç–æ—Ä –∏–∑ —Ñ–∞–π–ª–∞ - –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ –≤–∏–¥–µ —Å–ª–æ–≤–∞—Ä—è
        for row in reader:
            try:
                region = row["region"]
                children = int(row["children_5_7"]) # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –≤ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
                rent = int(row["avg_rent_per_sqm"]) # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –≤ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
                # –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Å–ª–æ–≤–∞—Ä—å
                regions_data[region] = {
                    "children_5_7": children,
                    "avg_rent_per_sqm": rent
                }
            except (KeyError, ValueError, TypeError): # –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤ –æ–¥–Ω–æ
                # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏ –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
                continue
    
    return regions_data

def load_businesses(filename='businesses.csv'):
    """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –±–∏–∑–Ω–µ—Å–∞—Ö –∏–∑ CSV-—Ñ–∞–π–ª–∞.
    
    –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:
        region;ip_count
        –ö–∞–∑–∞–Ω—å;376
        ...
        
    Args:
        filename (str, optional): –ü—É—Ç—å –∫ CSV-—Ñ–∞–π–ª—É —Å –¥–∞–Ω–Ω—ã–º–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 'businesses.csv'.
        
    Returns:
        dict: –°–ª–æ–≤–∞—Ä—å, –≥–¥–µ –∫–ª—é—á–∏ - –Ω–∞–∑–≤–∞–Ω–∏—è —Ä–µ–≥–∏–æ–Ω–æ–≤, –∑–Ω–∞—á–µ–Ω–∏—è - —Å–ª–æ–≤–∞—Ä–∏ —Å –¥–∞–Ω–Ω—ã–º–∏:
            {
                "–ö–∞–∑–∞–Ω—å": {"ip_count": 376},
                ...
            }
            
    –ò—Å–∫–ª—é—á–µ–Ω–∏—è:
        FileNotFoundError: –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω.
        KeyError, ValueError, TypeError: –ü—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª–µ.
    """
    businesses_data = {} # –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –±–∏–∑–Ω–µ—Å–æ–≤ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º –∏ –û–ö–í–ï–î
    
    with open(filename, "r", encoding="utf-8") as file: # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
        # –£–∫–∞–∑—ã–≤–∞–µ–º delimiter=';', —Ç–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π
        reader = csv.DictReader(file, delimiter=";") # –°–æ–∑–¥–∞–µ–º –∏—Ç–µ—Ä–∞—Ç–æ—Ä –∏–∑ —Ñ–∞–π–ª–∞ - –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ –≤–∏–¥–µ —Å–ª–æ–≤–∞—Ä—è
        for row in reader:
            try:
                region = row["region"]  # –ü–æ–ª—É—á–∞–µ–º —Ä–µ–≥–∏–æ–Ω
                ip_count = int(row["ip_count"])  # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –≤ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
                # –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Å–ª–æ–≤–∞—Ä—å
                businesses_data[region] = {
                    "ip_count": ip_count,
                }   
            except (KeyError, ValueError, TypeError): # –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤ –æ–¥–Ω–æ
                # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏ –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
                continue
            
    return businesses_data                  

def load_assumptions(filename='assumptions.csv'):
    """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è—Ö –∏–∑ CSV-—Ñ–∞–π–ª–∞.
    
    –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:
        region;param;value
        –ö–∞–∑–∞–Ω—å;area_sqm;40
        ...
        
    Args:
        filename (str, optional): –ü—É—Ç—å –∫ CSV-—Ñ–∞–π–ª—É —Å –¥–∞–Ω–Ω—ã–º–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 'assumptions.csv'.
        
    Returns:
        dict: –°–ª–æ–≤–∞—Ä—å, –≥–¥–µ –∫–ª—é—á–∏ - –Ω–∞–∑–≤–∞–Ω–∏—è —Ä–µ–≥–∏–æ–Ω–æ–≤, –∑–Ω–∞—á–µ–Ω–∏—è - —Å–ª–æ–≤–∞—Ä–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
            {
                "–ö–∞–∑–∞–Ω—å": {"area_sqm": 40, "param_name": value, ...},
                ...
            }
            
    –ò—Å–∫–ª—é—á–µ–Ω–∏—è:
        FileNotFoundError: –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω.
        KeyError, ValueError, TypeError: –ü—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª–µ.
    """
    assumptions_data = {} # –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è—Ö –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º

    with open(filename, "r", encoding="utf-8") as file: # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
        # –£–∫–∞–∑—ã–≤–∞–µ–º delimiter=';', —Ç–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π
        reader = csv.DictReader(file, delimiter=";") # –°–æ–∑–¥–∞–µ–º –∏—Ç–µ—Ä–∞—Ç–æ—Ä –∏–∑ —Ñ–∞–π–ª–∞ - –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ –≤–∏–¥–µ —Å–ª–æ–≤–∞—Ä—è
        for row in reader:
            try:
                region = row["region"]
                param=row["param"]
                value=int(row["value"]) # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –≤ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
                # –°–æ–∑–¥–∞–µ–º –ø–æ–¥—Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Ä–µ–≥–∏–æ–Ω–∞, –µ—Å–ª–∏ —Ä–µ–≥–∏–æ–Ω–∞ –Ω–µ—Ç –≤ —Å–ª–æ–≤–∞—Ä–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è—Ö
                if region not in assumptions_data:
                    assumptions_data[region] = {}
                # –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –ø–æ–¥—Å–ª–æ–≤–∞—Ä—å —Ä–µ–≥–∏–æ–Ω–∞
                assumptions_data[region][param] = value
                
            except (KeyError, ValueError, TypeError): # –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤ –æ–¥–Ω–æ
                # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏ –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
                continue

    return assumptions_data 

def select_regions(regions_dict):
    """–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–±—Ä–∞—Ç—å —Ä–µ–≥–∏–æ–Ω—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é.
    
    –§—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥–∏—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤—ã–±—Ä–∞—Ç—å —Ä–µ–∂–∏–º –∞–Ω–∞–ª–∏–∑–∞:
    - S: –ê–Ω–∞–ª–∏–∑ –æ–¥–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞
    - D: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤
    - A: –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤
    
    Args:
        regions_dict (dict): –°–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
            {
                "–ö–∞–∑–∞–Ω—å": {"children_5_7": 41800, "avg_rent_per_sqm": 1050},
                ...
            }
            
    Returns:
        list: –°–ø–∏—Å–æ–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.
        
    Raises:
        SystemExit: –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–¥–µ–ª–∞–ª –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤—ã–±–æ—Ä.
    """
    regions_list = sorted(regions_dict.keys()) # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤
    # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞: –≤—ã–≤–æ–¥ —Å–ø–∏—Å–∫–∞ —Ä–µ–≥–∏–æ–Ω–æ–≤, –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    selected_regions = [] # –°–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤
    
    # –í—ã–≤–æ–¥–∏–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤
    print('\n–î–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–≥–∏–æ–Ω—ã:')
    for index, region in enumerate(regions_list, 1):
        print(f'{index}. {region}')
    print(f'–í—Å–µ–≥–æ –≤ —Å–ø–∏—Å–∫–µ {len(regions_list)} —Ä–µ–≥–∏–æ–Ω–æ–≤.\n')
    
    # –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–±—Ä–∞—Ç—å —Ä–µ–∂–∏–º –∞–Ω–∞–ª–∏–∑–∞
    print('–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ —Ä–µ–∂–∏–º–∞ –∞–Ω–∞–ª–∏–∑–∞:')
    print('S - –ê–Ω–∞–ª–∏–∑ –æ–¥–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞')
    print('D - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤')
    print('A - –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤')
    
    # –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞ –∞–Ω–∞–ª–∏–∑–∞
    while True:
        mode = input('–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ —Ä–µ–∂–∏–º–∞: ')
        match mode:
            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –æ–¥–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞
            case 'S' | 's':
                while True:
                    choise_region = int(input('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ä–µ–≥–∏–æ–Ω–∞: '))
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–æ–º–µ—Ä —Ä–µ–≥–∏–æ–Ω–∞ –≤ –¥–æ–ø—É—Å—Ç–∏–º–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
                    if choise_region in range(1, len(regions_list)+1):
                        selected_regions.append(regions_list[choise_region-1])
                        print(f'\n–í—ã –≤—ã–±—Ä–∞–ª–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ {selected_regions[0]}')
                        return selected_regions
                    else:
                        print('\n–ù–µ–≤–µ—Ä–Ω–æ. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤—ã–±–æ—Ä —Ä–µ–≥–∏–æ–Ω–∞.\n')
            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–≤—É—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            case 'D' | 'd':
                while True:
                    choise_region1 = int(input('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –ø–µ—Ä–≤–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞: '))
                    choise_region2 = int(input('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –≤—Ç–æ—Ä–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞: '))
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ–±–∞ –Ω–æ–º–µ—Ä–∞ —Ä–µ–≥–∏–æ–Ω–æ–≤ –≤ –¥–æ–ø—É—Å—Ç–∏–º–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ –∏ –Ω–µ —Ä–∞–≤–Ω—ã –¥—Ä—É–≥ –¥—Ä—É–≥—É
                    if choise_region1 in range(1, len(regions_list)+1) and\
                    choise_region2 in range(1, len(regions_list)+1) and\
                    choise_region1 != choise_region2:
                        selected_regions.append(regions_list[choise_region1-1])
                        selected_regions.append(regions_list[choise_region2-1])
                        print(f'\n–í—ã –≤—ã–±—Ä–∞–ª–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ {selected_regions[0]} –∏ {selected_regions[1]}')
                        return selected_regions
                    else:
                        print('\n–ù–µ–≤–µ—Ä–Ω–æ. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤—ã–±–æ—Ä —Ä–µ–≥–∏–æ–Ω–æ–≤.\n')
            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Å–µ—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤
            case 'A' | 'a':
                selected_regions = regions_list
                print(f'\n–í—ã –≤—ã–±—Ä–∞–ª–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤—Å–µ —Ä–µ–≥–∏–æ–Ω—ã')
                return selected_regions
            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤–≤–æ–¥–∞
            case _:
                print('\n–ù–µ–≤–µ—Ä–Ω–æ. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞.\n')

def calculate_financials(region, reg_data, bus_data, ass_data):
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –¥–ª—è —Ä–µ–≥–∏–æ–Ω–∞.
    
    Args:
        region (str): –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞.
        reg_data (dict): –°–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ –æ —Ä–µ–≥–∏–æ–Ω–µ.
        bus_data (dict): –°–ª–æ–≤–∞—Ä—å —Å –±–∏–∑–Ω–µ—Å-–ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ –¥–ª—è —Ä–µ–≥–∏–æ–Ω–∞.
        ass_data (dict): –°–ª–æ–≤–∞—Ä—å —Å –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è–º–∏ –¥–ª—è —Ä–µ–≥–∏–æ–Ω–∞.
        
    Returns:
        dict: –°–ª–æ–≤–∞—Ä—å —Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ –¥–ª—è —Ä–µ–≥–∏–æ–Ω–∞.
        
    –ò—Å–∫–ª—é—á–µ–Ω–∏—è:
        KeyError: –ï—Å–ª–∏ –≤ —Å–ª–æ–≤–∞—Ä—è—Ö reg_data, bus_data –∏–ª–∏ ass_data –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–ª—é—á–∏.
        TypeError: –ï—Å–ª–∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ —Å–ª–æ–≤–∞—Ä—è—Ö reg_data, bus_data –∏–ª–∏ ass_data –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã.
        ZeroDivisionError: –ü—Ä–∏ –¥–µ–ª–µ–Ω–∏–∏ –Ω–∞ –Ω–æ–ª—å –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏.
    """
    
    # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
    rent = reg_data['avg_rent_per_sqm'] * ass_data['area_sqm']   # —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –∞—Ä–µ–Ω–¥—É (–µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ)
    salaries = ass_data['teachers'] * ass_data['salary_per_teacher']   # –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ —Ü–µ–Ω—Ç—Ä–∞
    
    monthly_sales_volume = 60   # –æ–±—ä–µ–º –ø—Ä–æ–¥–∞–∂ –≤ –º–µ—Å—è—Ü (–±–∞–∑–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π)
    initial_investment = 500000   # –Ω–∞—á–∞–ª—å–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –±–∏–∑–Ω–µ—Å
    
    total_costs = rent + salaries + ass_data['marketing'] + ass_data['other_costs']   # –æ–±—â–∏–µ –º–µ—Å—è—á–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã
    monthly_revenue = ass_data['avg_check'] * monthly_sales_volume   # –º–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞
    profit = monthly_revenue - total_costs   # —á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å –≤ –º–µ—Å—è—Ü
    profitability = round((profit / monthly_revenue) * 100, 1)   # —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å
    
    match profitability:
        case x if x <= 10:
            profitability_level = 'low'   # –Ω–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
        case x if x <= 25:
            profitability_level = 'regular'   # –æ–±—ã—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
        case x if x > 25:
            profitability_level = 'high'   # –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
    
    break_even_children = math.ceil(total_costs / ass_data['avg_check'])   # —Ç–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏
    competition_density = round(bus_data['ip_count'] / (reg_data['children_5_7'] / 1000), 1)   # –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
    
    match competition_density:
        case x if x <= 8:
            competition_level = 'low'   # –Ω–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
        case x if x <= 12:
            competition_level = 'medium'   # —É–º–µ—Ä–µ–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
        case x if x > 12:
            competition_level = 'high'   # –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
    
    if profit > 0:
        payback_period_month = math.ceil(initial_investment / profit)   # —Å—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ –≤ –ø–æ–ª–Ω—ã—Ö –º–µ—Å—è—Ü–∞—Ö
    else:
        payback_period_month = 'no payback'

    return {
        'region': region,
        'children_5_7': reg_data['children_5_7'],
        'ip_count': bus_data['ip_count'],
        'total_costs': total_costs,
        'monthly_revenue': monthly_revenue,
        'profit': profit,
        'profitability': profitability,
        'profitability_level': profitability_level,
        'break_even_children': break_even_children,
        'competition_density': competition_density,
        'competition_level': competition_level,
        'payback_period_month': payback_period_month
    }    

def generate_single_report(result):
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç
    —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∫–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏,
    –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä—ã–Ω–∫–µ –∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏, –∞ —Ç–∞–∫–∂–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏.
    –û—Ç—á—ë—Ç –≤–∫–ª—é—á–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –ø–æ –∑–∞–ø—É—Å–∫—É –±–∏–∑–Ω–µ—Å–∞.
    
    Args:
        result (dict): –°–ª–æ–≤–∞—Ä—å —Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ —Ä–µ–≥–∏–æ–Ω–∞, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∏–∑
            —Ñ—É–Ω–∫—Ü–∏–∏ calculate_financials(). –î–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª—é—á–∏:
            - 'region': –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ (str)
            - 'children_5_7': –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ç–µ–π 5-7 –ª–µ—Ç (int)
            - 'ip_count': –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –ò–ü (int)
            - 'total_costs': –û–±—â–∏–µ –º–µ—Å—è—á–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã (int)
            - 'monthly_revenue': –ú–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ (int)
            - 'profit': –ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å –≤ –º–µ—Å—è—Ü (int)
            - 'profitability': –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (float)
            - 'profitability_level': –£—Ä–æ–≤–µ–Ω—å —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ ('low', 'regular', 'high') (str)
            - 'break_even_children': –¢–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ (–∫–æ–ª-–≤–æ –¥–µ—Ç–µ–π) (int)
            - 'competition_density': –ü–ª–æ—Ç–Ω–æ—Å—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ (float)
            - 'competition_level': –£—Ä–æ–≤–µ–Ω—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ ('low', 'medium', 'high') (str)
            - 'payback_period_month': –°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ –≤ –º–µ—Å—è—Ü–∞—Ö (int –∏–ª–∏ str)
        
    Returns:
        str: –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç —Å –∞–Ω–∞–ª–∏–∑–æ–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
            –¥–µ—Ç—Å–∫–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞ —Ä–∞–∑–≤–∏—Ç–∏—è –≤ –∑–∞–¥–∞–Ω–Ω–æ–º —Ä–µ–≥–∏–æ–Ω–µ.
            
    Example:
        >>> result = {
        ...     'region': '–ö–∞–∑–∞–Ω—å',
        ...     'children_5_7': 41800,
        ...     'ip_count': 376,
        ...     'total_costs': 250000,
        ...     'monthly_revenue': 300000,
        ...     'profit': 50000,
        ...     'profitability': 16.7,
        ...     'profitability_level': 'regular',
        ...     'break_even_children': 42,
        ...     'competition_density': 9.0,
        ...     'competition_level': 'low',
        ...     'payback_period_month': 10
        ... }
        >>> report = generate_single_report(result)
        >>> print(report[:50])
        –ê–ù–ê–õ–ò–ó –§–ò–ù–ê–ù–°–û–í–û–ô –≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–ò
        –î–µ—Ç—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä —Ä–∞–∑–≤–∏—Ç–∏—è –≤ –≥. –ö–∞–∑–∞–Ω—å
    """
    # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.
    region = result['region']
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–π –º–µ—Ç–∫–∏ –¥–ª—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
    profit_label = profitability_labels.get(result['profitability_level'], '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π')
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–π –º–µ—Ç–∫–∏ –¥–ª—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
    comp_label = competition_labels.get(result['competition_level'], '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π')
    
    # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–∞
    report = f"""–ê–ù–ê–õ–ò–ó –§–ò–ù–ê–ù–°–û–í–û–ô –≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–ò
–î–µ—Ç—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä —Ä–∞–∑–≤–∏—Ç–∏—è –≤ –≥. {region}

üìä –û–°–ù–û–í–ù–´–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ò:
‚Ä¢ –ú–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ (60 –¥–µ—Ç–µ–π):     {format_currency(result['monthly_revenue'])} ‚ÇΩ
‚Ä¢ –ú–µ—Å—è—á–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã:                {format_currency(result['total_costs'])} ‚ÇΩ
‚Ä¢ –ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å:                   {format_currency(result['profit'])} ‚ÇΩ
‚Ä¢ –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å:                   {result['profitability']}% ({profit_label} —É—Ä–æ–≤–µ–Ω—å)
‚Ä¢ –¢–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏:             {result['break_even_children']} –¥–µ—Ç–µ–π –≤ –º–µ—Å—è—Ü

üìà –†–´–ù–û–ö –ò –ö–û–ù–ö–£–†–ï–ù–¶–ò–Ø:
‚Ä¢ –î–µ—Ç–µ–π 5‚Äì7 –ª–µ—Ç –≤ –≥–æ—Ä–æ–¥–µ:           {format_currency(int(result.get('children_5_7', 0)))} —á–µ–ª.
‚Ä¢ –î–µ–π—Å—Ç–≤—É—é—â–∏—Ö –ò–ü (–û–ö–í–≠–î 85.59):     {result.get('ip_count', '‚Äî')}
‚Ä¢ –ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è:                      {result['competition_density']} –ò–ü –Ω–∞ 1000 –¥–µ—Ç–µ–π ({comp_label} —É—Ä–æ–≤–µ–Ω—å)

üí∞ –ò–ù–í–ï–°–¢–ò–¶–ò–ò:
‚Ä¢ –ù–∞—á–∞–ª—å–Ω—ã–µ –≤–ª–æ–∂–µ–Ω–∏—è:               500 000 ‚ÇΩ
‚Ä¢ –°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏:                 {result['payback_period_month']} –º–µ—Å—è—Ü–µ–≤

–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:
"""
    
    # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–±—ã–ª–∏, —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —É—Ä–æ–≤–Ω—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
    if result['profit'] <= 0:
        # –ë–∏–∑–Ω–µ—Å —É–±—ã—Ç–æ—á–µ–Ω - –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫ –∑–∞–ø—É—Å–∫—É –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        recommendation = '–ë–∏–∑–Ω–µ—Å —É–±—ã—Ç–æ—á–µ–Ω –ø—Ä–∏ —Ç–µ–∫—É—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö. –ó–∞–ø—É—Å–∫ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –±–µ–∑ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∞ –º–æ–¥–µ–ª–∏ (—Å–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤ –∏–ª–∏ —Ä–æ—Å—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞).'
    elif result['profitability_level'] == 'high' and result['competition_level'] == 'low':
        # –í—ã—Å–æ–∫–∞—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –∏ –Ω–∏–∑–∫–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è - –∏–¥–µ–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞
        recommendation = '–ë–∏–∑–Ω–µ—Å –æ–±–ª–∞–¥–∞–µ—Ç –≤—ã—Å–æ–∫–æ–π —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ –Ω–∏–∑–∫–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–µ–π. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫ –∑–∞–ø—É—Å–∫—É.'
    elif result['competition_level'] == 'high':
        # –í—ã—Å–æ–∫–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è - —Ç—Ä–µ–±—É–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ —Ç–æ—Ä–≥–æ–≤–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
        recommendation = '–†—ã–Ω–æ–∫ –ø–µ—Ä–µ–Ω–∞—Å—ã—â–µ–Ω. –ó–∞–ø—É—Å–∫ –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º –£–¢–ü (—É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ) –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–µ.'
    else:
        # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è - —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω—ã–π –±–∏–∑–Ω–µ—Å —Å —É–º–µ—Ä–µ–Ω–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏
        recommendation = f'–ë–∏–∑–Ω–µ—Å —Ä–µ–Ω—Ç–∞–±–µ–ª–µ–Ω –∏ –∏–º–µ–µ—Ç {profit_label} —É—Ä–æ–≤–µ–Ω—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. ' \
                         f'–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫ –∑–∞–ø—É—Å–∫—É –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ –Ω–∞–±–æ—Ä–∞ –º–∏–Ω–∏–º—É–º {result['break_even_children']} –¥–µ—Ç–µ–π –≤ –º–µ—Å—è—Ü.'
    
    report += recommendation
    return report

def generate_comparison_report(financials_list):
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –¥–ª—è –¥–≤—É—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –¥–ª—è –¥–≤—É—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç
    —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Ç–∞–±–ª–∏—Ü—É —Å –∫–ª—é—á–µ–≤—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏
    –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π –ø–æ –≤—ã–±–æ—Ä—É —Ä–µ–≥–∏–æ–Ω–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–∏–∑–Ω–µ—Å–∞.
    
    Args:
        financials_list (list): –°–ø–∏—Å–æ–∫ –∏–∑ –¥–≤—É—Ö —Å–ª–æ–≤–∞—Ä–µ–π ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ calculate_financials.
            –ö–∞–∂–¥—ã–π —Å–ª–æ–≤–∞—Ä—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª—é—á–∏:
            - 'region': –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ (str)
            - 'profit': –ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å –≤ –º–µ—Å—è—Ü (int)
            - 'profitability': –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (float)
            - 'profitability_level': –£—Ä–æ–≤–µ–Ω—å —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ ('low', 'regular', 'high') (str)
            - 'break_even_children': –¢–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ (–∫–æ–ª-–≤–æ –¥–µ—Ç–µ–π) (int)
            - 'competition_density': –ü–ª–æ—Ç–Ω–æ—Å—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ (float)
            - 'competition_level': –£—Ä–æ–≤–µ–Ω—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ ('low', 'medium', 'high') (str)
            - 'payback_period_month': –°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ –≤ –º–µ—Å—è—Ü–∞—Ö (int –∏–ª–∏ str)
        
    Returns:
        str: –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç —Å —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π
            —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–µ—Ç—Å–∫–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞ —Ä–∞–∑–≤–∏—Ç–∏—è –≤ –¥–≤—É—Ö –∑–∞–¥–∞–Ω–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö.
            
    Raises:
        ValueError: –ï—Å–ª–∏ –≤ —Å–ø–∏—Å–∫–µ financials_list —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –Ω–µ —Ä–æ–≤–Ω–æ –¥–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–∞.
        
    Example:
        >>> financials_list = [
        ...     {
        ...         'region': '–ö–∞–∑–∞–Ω—å',
        ...         'profit': 50000,
        ...         'profitability': 16.7,
        ...         'profitability_level': 'regular',
        ...         'break_even_children': 42,
        ...         'competition_density': 9.0,
        ...         'competition_level': 'low',
        ...         'payback_period_month': 10
        ...     },
        ...     {
        ...         'region': '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥',
        ...         'profit': 30000,
        ...         'profitability': 10.0,
        ...         'profitability_level': 'low',
        ...         'break_even_children': 50,
        ...         'competition_density': 15.0,
        ...         'competition_level': 'medium',
        ...         'payback_period_month': 17
        ...     }
        ... ]
        >>> report = generate_comparison_report(financials_list)
        >>> print(report[:50])
        –°–†–ê–í–ù–ò–¢–ï–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó
        –ö–∞–∑–∞–Ω—å vs –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥
    """
    # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –¥–ª—è –¥–≤—É—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤.
    # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –≤ —Å–ø–∏—Å–∫–µ —Ä–æ–≤–Ω–æ –¥–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
    if len(financials_list) != 2:
        raise ValueError('–û–∂–∏–¥–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ —Ä–æ–≤–Ω–æ –¥–ª—è –¥–≤—É—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤.')
    
    # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º
    r1, r2 = financials_list[0], financials_list[1]
    region1, region2 = r1['region'], r2['region']
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –º–µ—Ç–æ–∫ –¥–ª—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
    profit_labels = profitability_labels
    comp_labels = competition_labels
    
    # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º print_fancy_table
    headers = ["–ü–û–ö–ê–ó–ê–¢–ï–õ–¨", region1, region2]
    rows = [
        ["–ú–µ—Å—è—á–Ω–∞—è –ø—Ä–∏–±—ã–ª—å", r1['profit'], r2['profit']],
        ["–†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å", f"{r1['profitability']:.1f}% ({profit_labels[r1['profitability_level']]})", f"{r2['profitability']:.1f}% ({profit_labels[r2['profitability_level']]})"],
        ["–¢–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏", f"{r1['break_even_children']} –¥–µ—Ç–µ–π", f"{r2['break_even_children']} –¥–µ—Ç–µ–π"],
        ["–ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è", f"{r1['competition_density']:.1f} ({comp_labels[r1['competition_level']]})", f"{r2['competition_density']:.1f} ({comp_labels[r2['competition_level']]})"],
        ["–°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏", f"{r1['payback_period_month']} –º–µ—Å.", f"{r2['payback_period_month']} –º–µ—Å."]
    ]
    
    # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ç–∞–±–ª–∏—Ü—É —Å —É–∫–∞–∑–∞–Ω–∏–µ–º, —á—Ç–æ –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ–Ω–µ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    table_output = format_fancy_table(headers, rows, currency_columns=[1, 2])
    
    # –†–∞—Å—á–µ—Ç —Ä–∞–∑–Ω–∏—Ü—ã –≤ –ø—Ä–∏–±—ã–ª–∏ –º–µ–∂–¥—É —Ä–µ–≥–∏–æ–Ω–∞–º–∏
    profit_diff = r2['profit'] - r1['profit']
    
    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º
    # –ü—Ä–∏–±—ã–ª—å: –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —É –≤—Ç–æ—Ä–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ –≤—ã—à–µ –ø—Ä–∏–±—ã–ª—å
    profit_better = region2 if profit_diff > 0 else (region1 if profit_diff < 0 else '—Ä–∞–≤–Ω—ã')
    
    # –¢–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏: —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –Ω–∞–ø—Ä—è–º—É—é (–º–µ–Ω—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ª—É—á—à–µ)
    be_children_diff = r2['break_even_children'] - r1['break_even_children']
    be_better = region1 if be_children_diff > 0 else (region2 if be_children_diff < 0 else '—Ä–∞–≤–Ω—ã')
    
    # –ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è: —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ (–º–µ–Ω—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ª—É—á—à–µ)
    comp_diff = r2['competition_density'] - r1['competition_density']
    comp_better = region1 if comp_diff > 0 else (region2 if comp_diff < 0 else '—Ä–∞–≤–Ω—ã')
    
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–æ–ª–µ–µ –≤—ã–≥–æ–¥–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ –ø–æ –ø—Ä–∏–±—ã–ª–∏
    if profit_diff > 0:
        # –í—Ç–æ—Ä–æ–π —Ä–µ–≥–∏–æ–Ω –±–æ–ª–µ–µ –≤—ã–≥–æ–¥–µ–Ω –ø–æ –ø—Ä–∏–±—ã–ª–∏
        better_region = region2
        # –†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–π —Ä–∞–∑–Ω–∏—Ü—ã –≤ –ø—Ä–∏–±—ã–ª–∏
        diff_pct = abs(profit_diff) / r1['profit'] * 100 if r1['profit'] != 0 else 0
        profit_advantage = f' ‚Äî –≤—ã—à–µ –ø—Ä–∏–±—ã–ª—å (+{profit_diff:,} ‚ÇΩ, +{diff_pct:.0f}%)'
    elif profit_diff < 0:
        # –ü–µ—Ä–≤—ã–π —Ä–µ–≥–∏–æ–Ω –±–æ–ª–µ–µ –≤—ã–≥–æ–¥–µ–Ω –ø–æ –ø—Ä–∏–±—ã–ª–∏
        better_region = region1
        # –†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–π —Ä–∞–∑–Ω–∏—Ü—ã –≤ –ø—Ä–∏–±—ã–ª–∏
        diff_pct = abs(profit_diff) / r2['profit'] * 100 if r2['profit'] != 0 else 0
        profit_advantage = f' ‚Äî –≤—ã—à–µ –ø—Ä–∏–±—ã–ª—å (+{abs(profit_diff):,} ‚ÇΩ, +{diff_pct:.0f}%)'
    else:
        # –†–µ–≥–∏–æ–Ω—ã —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã –ø–æ –ø—Ä–∏–±—ã–ª–∏
        better_region = '–û–±–∞ —Ä–µ–≥–∏–æ–Ω–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã'
        profit_advantage = ' ‚Äî –ø—Ä–∏–±—ã–ª—å —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–∞'
    
    # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–≤–æ–¥–∞ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –ø–æ –∫–∞–∂–¥–æ–º—É –ø–æ–∫–∞–∑–∞—Ç–µ–ª—é
    if be_better == comp_better and be_better == better_region and better_region not in ['–û–±–∞ —Ä–µ–≥–∏–æ–Ω–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã', '—Ä–∞–≤–Ω—ã']:
        # –í—Å–µ —Ç—Ä–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –≤ –ø–æ–ª—å–∑—É –æ–¥–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞
        advantage = f'{better_region} –≤—ã–≥–æ–¥–Ω–µ–µ –ø–æ –≤—Å–µ–º –∫–ª—é—á–µ–≤—ã–º –º–µ—Ç—Ä–∏–∫–∞–º:\n' \
                    f'{profit_advantage},\n' \
                    f' ‚Äî –Ω–∏–∂–µ —Ç–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ ({r1["break_even_children"]} vs {r2["break_even_children"]} –¥–µ—Ç–µ–π),\n' \
                    f' ‚Äî —Å–ª–∞–±–µ–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è ({r1["competition_density"]:.1f} vs {r2["competition_density"]:.1f} –ò–ü/1000 –¥–µ—Ç–µ–π).'
    else:
        # –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –º–µ–∂–¥—É —Ä–µ–≥–∏–æ–Ω–∞–º–∏
        advantage_lines = [f'{better_region} –≤—ã–≥–æ–¥–Ω–µ–µ –ø–æ –ø—Ä–∏–±—ã–ª–∏:{profit_advantage}']
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ—á–∫–µ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏
        if be_better not in ['—Ä–∞–≤–Ω—ã', better_region]:
            advantage_lines.append(f'{be_better} –∏–º–µ–µ—Ç –±–æ–ª–µ–µ –Ω–∏–∑–∫—É—é —Ç–æ—á–∫—É –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ ({r1["break_even_children"]} vs {r2["break_even_children"]} –¥–µ—Ç–µ–π)')
        elif be_better == '—Ä–∞–≤–Ω—ã':
            advantage_lines.append('–¢–æ—á–∫–∏ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã')
        else:
            advantage_lines.append(f'{be_better} –∏–º–µ–µ—Ç –±–æ–ª–µ–µ –Ω–∏–∑–∫—É—é —Ç–æ—á–∫—É –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ ({r1["break_even_children"]} vs {r2["break_even_children"]} –¥–µ—Ç–µ–π)')
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
        if comp_better not in ['—Ä–∞–≤–Ω—ã', better_region]:
            advantage_lines.append(f'{comp_better} –∏–º–µ–µ—Ç —Å–ª–∞–±–µ–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é ({r1["competition_density"]:.1f} vs {r2["competition_density"]:.1f} –ò–ü/1000 –¥–µ—Ç–µ–π)')
        elif comp_better == '—Ä–∞–≤–Ω—ã':
            advantage_lines.append('–£—Ä–æ–≤–µ–Ω—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º')
        else:
            advantage_lines.append(f'{comp_better} –∏–º–µ–µ—Ç —Å–ª–∞–±–µ–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é ({r1["competition_density"]:.1f} vs {r2["competition_density"]:.1f} –ò–ü/1000 –¥–µ—Ç–µ–π)')
        
        advantage = '\n'.join([f'‚Ä¢ {line}' for line in advantage_lines])
    
    # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
    if r1['profit'] <= 0 and r2['profit'] <= 0:
        # –û–±–∞ —Ä–µ–≥–∏–æ–Ω–∞ —É–±—ã—Ç–æ—á–Ω—ã
        recommendation = '–û–±–∞ —Ä–µ–≥–∏–æ–Ω–∞ —É–±—ã—Ç–æ—á–Ω—ã –ø—Ä–∏ —Ç–µ–∫—É—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö. –ó–∞–ø—É—Å–∫ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –±–µ–∑ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∞ –±–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª–∏.'
    elif r1['profit'] <= 0:
        # –¢–æ–ª—å–∫–æ –≤—Ç–æ—Ä–æ–π —Ä–µ–≥–∏–æ–Ω —Ä–µ–Ω—Ç–∞–±–µ–ª–µ–Ω
        recommendation = f'–¢–æ–ª—å–∫–æ {region2} —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω—ã–º. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–±—Ä–∞—Ç—å –µ–≥–æ.'
    elif r2['profit'] <= 0:
        # –¢–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π —Ä–µ–≥–∏–æ–Ω —Ä–µ–Ω—Ç–∞–±–µ–ª–µ–Ω
        recommendation = f'–¢–æ–ª—å–∫–æ {region1} —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω—ã–º. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–±—Ä–∞—Ç—å –µ–≥–æ.'
    else:
        # –û–±–∞ —Ä–µ–≥–∏–æ–Ω–∞ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω—ã, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –±–æ–ª–µ–µ –≤—ã–≥–æ–¥–Ω—ã–π —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
        # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º "–ø–æ–±–µ–¥—ã" –ø–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º
        wins = {region1: 0, region2: 0}
        if profit_diff > 0:
            wins[region2] += 1
        elif profit_diff < 0:
            wins[region1] += 1
            
        if be_children_diff > 0:  # r1 –∏–º–µ–µ—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é —Ç–æ—á–∫—É –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏
            wins[region2] += 1
        elif be_children_diff < 0:
            wins[region1] += 1
            
        if comp_diff > 0:  # r1 –∏–º–µ–µ—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é
            wins[region2] += 1
        elif comp_diff < 0:
            wins[region1] += 1
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –ø–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤—É –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
        if wins[region1] > wins[region2]:
            overall_better = region1
        elif wins[region2] > wins[region1]:
            overall_better = region2
        else:
            overall_better = '–û–±–∞ —Ä–µ–≥–∏–æ–Ω–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã –ø–æ –∫–ª—é—á–µ–≤—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º'
        
        if overall_better == '–û–±–∞ —Ä–µ–≥–∏–æ–Ω–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã –ø–æ –∫–ª—é—á–µ–≤—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º':
            recommendation = '–†–µ–≥–∏–æ–Ω—ã —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã –ø–æ –∫–ª—é—á–µ–≤—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º. –í—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ (–ª–∏—á–Ω—ã–µ —Å–≤—è–∑–∏, –ø–æ–º–µ—â–µ–Ω–∏–µ –∏ —Ç.–¥.).'
        else:
            recommendation = f'–ü—Ä–∏ –ø—Ä–æ—á–∏—Ö —Ä–∞–≤–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ —Å—Ç–æ–∏—Ç –æ—Ç–¥–∞—Ç—å {overall_better}, –∫–æ—Ç–æ—Ä—ã–π –ª–∏–¥–∏—Ä—É–µ—Ç –ø–æ {wins[overall_better]} –∏–∑ 3 –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.'
    
    # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á—ë—Ç–∞
    report = f"""–°–†–ê–í–ù–ò–¢–ï–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó
{region1} vs {region2}

{table_output}
–ê–ù–ê–õ–ò–¢–ò–ß–ï–°–ö–ò–ô –í–´–í–û–î:
{advantage}

–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:
{recommendation}
"""
    return report

def generate_overview_report(financials_list):
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ –≤—Å–µ–º —Ä–µ–≥–∏–æ–Ω–∞–º (3 –∏ –±–æ–ª–µ–µ) –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç
    —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Ç–∞–±–ª–∏—Ü—É —Å –∫–ª—é—á–µ–≤—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏,
    —Ç–æ–ø-—Ä–µ–π—Ç–∏–Ω–≥–∏ –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º –∏ –æ–±—â–∏–π –≤—ã–≤–æ–¥ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π.
    
    Args:
        financials_list (list): –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ calculate_financials –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞.
            –ö–∞–∂–¥—ã–π —Å–ª–æ–≤–∞—Ä—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª—é—á–∏:
            - 'region': –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ (str)
            - 'profit': –ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å –≤ –º–µ—Å—è—Ü (int)
            - 'profitability': –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (float)
            - 'profitability_level': –£—Ä–æ–≤–µ–Ω—å —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ ('low', 'regular', 'high') (str)
            - 'break_even_children': –¢–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ (–∫–æ–ª-–≤–æ –¥–µ—Ç–µ–π) (int)
            - 'competition_density': –ü–ª–æ—Ç–Ω–æ—Å—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ (float)
            - 'competition_level': –£—Ä–æ–≤–µ–Ω—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ ('low', 'medium', 'high') (str)
            - 'payback_period_month': –°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ –≤ –º–µ—Å—è—Ü–∞—Ö (int –∏–ª–∏ str)
        
    Returns:
        str: –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç —Å–æ —Å–≤–æ–¥–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π
            —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–µ—Ç—Å–∫–∏—Ö —Ü–µ–Ω—Ç—Ä–æ–≤ —Ä–∞–∑–≤–∏—Ç–∏—è –ø–æ –≤—Å–µ–º –∑–∞–¥–∞–Ω–Ω—ã–º —Ä–µ–≥–∏–æ–Ω–∞–º.
            
    Raises:
        ValueError: –ï—Å–ª–∏ –≤ —Å–ø–∏—Å–∫–µ financials_list —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –º–µ–Ω–µ–µ –¥–≤—É—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
        
    Example:
        >>> financials_list = [
        ...     {
        ...         'region': '–ö–∞–∑–∞–Ω—å',
        ...         'profit': 50000,
        ...         'profitability': 16.7,
        ...         'profitability_level': 'regular',
        ...         'break_even_children': 42,
        ...         'competition_density': 9.0,
        ...         'competition_level': 'low',
        ...         'payback_period_month': 10
        ...     },
        ...     {
        ...         'region': '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥',
        ...         'profit': 30000,
        ...         'profitability': 10.0,
        ...         'profitability_level': 'low',
        ...         'break_even_children': 50,
        ...         'competition_density': 15.0,
        ...         'competition_level': 'medium',
        ...         'payback_period_month': 17
        ...     },
        ...     {
        ...         'region': '–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä',
        ...         'profit': 70000,
        ...         'profitability': 25.0,
        ...         'profitability_level': 'high',
        ...         'break_even_children': 35,
        ...         'competition_density': 7.0,
        ...         'competition_level': 'low',
        ...         'payback_period_month': 8
        ...     }
        ... ]
        >>> report = generate_overview_report(financials_list)
        >>> print(report[:50])
        –°–í–û–î–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–û 3 –†–ï–ì–ò–û–ù–ê–ú
        
    """
    # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Ä–µ–≥–∏–æ–Ω–∞–º.
    # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –≤ —Å–ø–∏—Å–∫–µ –º–∏–Ω–∏–º—É–º –¥–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
    if len(financials_list) < 2:
        raise ValueError('–î–ª—è —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á—ë—Ç–∞ –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 —Ä–µ–≥–∏–æ–Ω–∞.')
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –ø—Ä–∏–±—ã–ª–∏ (–æ—Ç –±–æ–ª—å—à–µ–π –∫ –º–µ–Ω—å—à–µ–π) –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã
    sorted_regions = sorted(financials_list, key=lambda x: x['profit'], reverse=True)
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –º–µ—Ç–æ–∫ –¥–ª—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
    profit_labels = profitability_labels
    comp_labels = competition_labels
    
    # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º print_fancy_table
    headers = ["–†–ï–ì–ò–û–ù", "–ü–†–ò–ë–´–õ–¨", "–†–ï–ù–¢–ê–ë.", "–ö–û–ù–ö–£–†–ï–ù–¶–ò–Ø", "–û–ö–£–ü–ê–ï–ú–û–°–¢–¨"]
    rows = []
    
    for r in sorted_regions:
        rentab_str = f'{r['profitability']:.1f}%'
        comp_str = f'{comp_labels[r['competition_level']]}'
        payback_str = f'{r['payback_period_month']} –º–µ—Å.'
        rows.append([r['region'], r['profit'], rentab_str, comp_str, payback_str])
    
    # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ç–∞–±–ª–∏—Ü—É —Å —É–∫–∞–∑–∞–Ω–∏–µ–º, —á—Ç–æ –≤—Ç–æ—Ä–æ–π —Å—Ç–æ–ª–±–µ—Ü —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ–Ω–µ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    table_output = format_fancy_table(headers, rows, currency_columns=[1])
    
    # --- –†–µ–π—Ç–∏–Ω–≥–∏ ---
    # –õ—É—á—à–∞—è –ø—Ä–∏–±—ã–ª—å
    best_profit = max(financials_list, key=lambda x: x['profit'])
    
    # –°–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å
    best_profitability = max(financials_list, key=lambda x: x['profitability'])
    
    # –ù–∞–∏–º–µ–Ω—å—à–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è
    best_competition = min(financials_list, key=lambda x: x['competition_density'])
    
    # –ë—ã—Å—Ç—Ä–µ–π—à–∞—è –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å (—Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)
    profitable_regions = [r for r in financials_list if isinstance(r['payback_period_month'], int)]
    if profitable_regions:
        # –ù–∞—Ö–æ–¥–∏–º —Ä–µ–≥–∏–æ–Ω —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Å—Ä–æ–∫–æ–º –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ —Å—Ä–µ–¥–∏ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω—ã—Ö
        best_payback = min(profitable_regions, key=lambda x: x['payback_period_month'])
        payback_line = f'üèÜ –ë—ã—Å—Ç—Ä–µ–π—à–∞—è –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å: {best_payback['region']} ({best_payback['payback_period_month']} –º–µ—Å—è—Ü–µ–≤)'
    else:
        # –ù–µ—Ç —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤
        payback_line = 'üèÜ –ë—ã—Å—Ç—Ä–µ–π—à–∞—è –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å: –Ω–µ—Ç —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤'
    
    # --- –û–±—â–∏–π –≤—ã–≤–æ–¥ ---
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω—ã–π —Ä–µ–≥–∏–æ–Ω
    profitable_count = len(profitable_regions)
    if profitable_count == 0:
        # –í—Å–µ —Ä–µ–≥–∏–æ–Ω—ã —É–±—ã—Ç–æ—á–Ω—ã
        conclusion = '–í—Å–µ —Ä–µ–≥–∏–æ–Ω—ã —É–±—ã—Ç–æ—á–Ω—ã –ø—Ä–∏ —Ç–µ–∫—É—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö. –ó–∞–ø—É—Å–∫ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –±–µ–∑ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∞ –±–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª–∏.'
    else:
        # –ò—â–µ–º —Ä–µ–≥–∏–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π –ª–∏–¥–∏—Ä—É–µ—Ç –ø–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É —á–∏—Å–ª—É –Ω–æ–º–∏–Ω–∞—Ü–∏–π
        leaders = {}
        for r in financials_list:
            leaders[r['region']] = 0
        
        # –ü–æ–¥—Å—á–µ—Ç –ø–æ–±–µ–¥ –≤ –∫–∞–∂–¥–æ–π –Ω–æ–º–∏–Ω–∞—Ü–∏–∏
        leaders[best_profit['region']] += 1
        leaders[best_profitability['region']] += 1
        leaders[best_competition['region']] += 1
        if profitable_regions:
            leaders[best_payback['region']] += 1
        
        # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –ª–∏–¥–µ—Ä–∞
        overall_leader = max(leaders, key=leaders.get)
        if leaders[overall_leader] >= 2:
            # –†–µ–≥–∏–æ–Ω –ª–∏–¥–∏—Ä—É–µ—Ç –∫–∞–∫ –º–∏–Ω–∏–º—É–º –≤ –¥–≤—É—Ö –Ω–æ–º–∏–Ω–∞—Ü–∏—è—Ö
            conclusion = f'{overall_leader} —è–≤–ª—è–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–º —Ä–µ–≥–∏–æ–Ω–æ–º –¥–ª—è –∑–∞–ø—É—Å–∫–∞\n–º–∏–Ω–∏-—Ü–µ–Ω—Ç—Ä–∞ —Ä–∞–∑–≤–∏—Ç–∏—è –ø–æ —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –∏ —Ä—ã–Ω–æ—á–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.'
        else:
            # –ù–µ—Ç —è–≤–Ω–æ–≥–æ –ª–∏–¥–µ—Ä–∞
            conclusion = '–õ–∏–¥–µ—Ä –ø–æ —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–µ –≤—ã—è–≤–ª–µ–Ω. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞.'
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞–∏–º–µ–Ω–µ–µ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–º —Ä–µ–≥–∏–æ–Ω–µ
        worst_region = min(financials_list, key=lambda x: x['profit'])
        if worst_region['competition_level'] == 'high' and worst_region['profitability_level'] == 'low':
            # –í—ã—Å–æ–∫–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è –∏ –Ω–∏–∑–∫–∞—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å
            conclusion += f'\n{worst_region['region']} ‚Äî –Ω–∞–∏–º–µ–Ω–µ–µ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª–µ–Ω –∏–∑-–∑–∞ –≤—ã—Å–æ–∫–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ –∏ –Ω–∏–∑–∫–æ–π —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏.'
    
    # --- –§–æ—Ä–º–∏—Ä—É–µ–º –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç ---
    report = f"""–°–í–û–î–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–û {len(financials_list)} –†–ï–ì–ò–û–ù–ê–ú

{table_output}
–¢–û–ü-–†–ï–ô–¢–ò–ù–ì–ò:
üèÜ –õ—É—á—à–∞—è –ø—Ä–∏–±—ã–ª—å:         {best_profit['region']} ({format_currency(best_profit['profit'])} ‚ÇΩ)
üèÜ –°–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: {best_profitability['region']} ({best_profitability['profitability']:.1f}%)
üèÜ –ù–∞–∏–º–µ–Ω—å—à–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è: {best_competition['region']} ({best_competition['competition_density']} –ò–ü/1000 –¥–µ—Ç–µ–π)
{payback_line}

–û–ë–©–ò–ô –í–´–í–û–î:
{conclusion}
"""
    return report

# === –û–°–ù–û–í–ù–ê–Ø –õ–û–ì–ò–ö–ê –í–´–ü–û–õ–ù–ï–ù–ò–Ø –ü–†–û–ì–†–ê–ú–ú–´ ===
#  –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
regions_dict = load_regions()   # –æ —Ä–µ–≥–∏–æ–Ω–∞—Ö
businesses_dict = load_businesses()   # –æ –±–∏–∑–Ω–µ—Å–∞—Ö
assumptions_dict = load_assumptions()   # –æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è—Ö

#  –≤—ã–±–∏—Ä–∞–µ–º —Ä–µ–≥–∏–æ–Ω—ã –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
selected_regions = sorted(select_regions(regions_dict))

#  —Ä–∞—Å—á–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞
results = {}
for region in selected_regions:
    regions_data = regions_dict[region]
    businesses_data = businesses_dict[region]
    assumptions_data = assumptions_dict[region]
    results[region] = calculate_financials(region, regions_data, businesses_data, assumptions_data)

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤
if len(selected_regions) == 1:
    # –î–ª—è –æ–¥–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ–¥–∏–Ω–æ—á–Ω—ã–π –æ—Ç—á–µ—Ç
    report = generate_single_report(results[selected_regions[0]])
    filename = f'report_single_{selected_regions[0]}.txt'
elif len(selected_regions) == 2:
    # –î–ª—è –¥–≤—É—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
    report = generate_comparison_report([results[r] for r in selected_regions])
    filename = f'report_compare_{selected_regions[0]}_{selected_regions[1]}.txt'
else:
    # –î–ª—è —Ç—Ä–µ—Ö –∏ –±–æ–ª–µ–µ —Ä–µ–≥–∏–æ–Ω–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç
    report = generate_overview_report(list(results.values()))
    filename = 'report_overview_all.txt'

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ –≤ —Ñ–∞–π–ª –∏ –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—à–Ω–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
with open(filename, 'w', encoding='utf-8') as f:
    f.write(report)
print(f'–û—Ç—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω: {filename}/')
